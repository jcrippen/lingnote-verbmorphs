%!TEX root = ../lingnote-verbmorphs.tex
%!TEX encoding = UTF-8 Unicode
%%%
%%% ExPex for numbered linguistic examples.
%%%

%% FIXME: This is a hack. Somewhere in expex (\judge ?) there's a hardcoded \rm that memoir dislikes.
\renewcommand{\rm}{\rmfamily}

%% FIXME: This is also a hack. Memoir also dislikes a hardcoded \tt which is caused by \getref.
\renewcommand{\tt}{\ttfamily}

%% FIXME: Hack number three. This is in conflict with something in unicode-math.
\let\gla\relax

\usepackage{expex}
\lingset{%
	% Type of numbering.
	exnotype=arabic,
	% Format of numbering.
	exnoformat=(X),
	% Formatting of \glpreamble line.
	everyglpreamble={\normalfont},
	% Formatting of \gla line.
	everygla={\normalfont},
	% Formatting of \glb line.
	everyglb={\normalfont},
	% Formatting of \glc line.
	everyglc={\romancondensedfont\small},
	% Formatting of \glft line.
	everyglft={\raggedright},
	% Formatting of a \trailingcitation{...}.
	everytrailingcitation={\footnotesize},
	% Horizontal space between aligned columns.
	glspace=1ex plus 0.25ex minus 0.75ex,
	% Vertical space above a \glb line.
	aboveglbskip=0pt,
	% Vertical space above a \glc line.
	aboveglcskip=0pt,
	% Vertical space above a \glb line.
	aboveglbskip=0pt,
	% Vertical space above a \glc line.
	aboveglcskip=0pt,
	% Vertical skip above a \glft line.
	aboveglftskip=0ex,
	% Vertical skip below a \glpreamble line.
	belowglpreambleskip=!-1ex,
	% Extra skip between interlinear gloss lines.
	extraglskip=0pt,
	% Vertical skip above an \ex ... \xe (whole example).
	aboveexskip=0.4375em plus 0.375em minus 0.5em,
	% Vertical skip below an \ex ... \xe (whole example).
	belowexskip=0.4375em plus 0.375em minus 0.5em,
	% Vertical skip between \a ... elements (example subparts).
	interpartskip=0.125em plus 0.125em minus 0.25em,
	% Horizontal offset of subpart labels.
	labeloffset=0.25em,
	% Horizontal offset of text (example content).
	textoffset=0.375em,
	% Minimum horizontal space before \trailingcitation.
	% If there is less than this before hitting the margin,
	% then it is shifted to the next line.
	mincitesep=0.25em,
	% Horizontal space for a stigma in \ljudge.
	*=*,
}
%\gathertags

%% Define additional gloss lines for spacing and formatting control.
%% The gld is for a word-level gloss.
%% The gle is for a loose gloss.
\defineglwlevels{d,e}
\lingset{%
	% Same settings as glc.	
	everygld={\romancondensedfont\small},
	abovegldskip=0pt,
	% Same settings as glb.
	everygle={\normalfont},
	abovegleskip=0pt,
}

%% Define a gloss line for phonetics.
%% This just switches to the ipafont.
\defineglwlevels{p}
\lingset{%
	everyglp={\ipafont},
	aboveglpskip=0pt,
}

%% Generate a fake \ex label, for use in e.g. \halign tables.
\ProvideDocumentCommand{\exfakelablel}{m}{#1.\hspace{\linglabeloffset}}

%% Set the ExPex example counter to a particular value.
\ProvideDocumentCommand{\setexcnt}{m}{\excnt=#1}

%% Resetting the ExPex example counter.
\ProvideDocumentCommand{\resetexcnt}{}{\setexcnt{1}}

%% Style for multipart examples with no glossing.
\definelingstyle{compact}{interpartskip=0em}

%% Style for word-order labels.
\definelingstyle{wordorder}{labelwidth=1.75em,labelformat={A:}}

%% Style for question-answer labels.
\definelingstyle{q-a-pair}{labelformat={Q:}}

%% A ombination of the above two styles.
\definelingstyle{compact-wordorder}{labelwidth=1.75em,labelformat={A:},interpartskip=0em}

%% Style for two column multipart examples.
\definelingstyle{twocols}{textoffset=0.75em}
\definelingstyle{compact-twocols}{interpartskip=0em, textoffset=0.75em}

%% Style for three column multipart examples.
\definelingstyle{threecols}{textoffset=0.75em}

%% Style for four column multipart examples.
\definelingstyle{fourcols}{textoffset=0.75em}

%% Style for trees in examples.
\definelingstyle{tree}{textoffset=0em}

%% Style for tables in examples.
\definelingstyle{table}{textoffset=0.5em}

%% Style for quoted examples inside quote environments.
%%
%% The numoffset parameter determines distance from the left margin (p. 11).
%% LaTeX actually sets \leftmargin at the start of the quote environment, but
%% ExPex doesnâ€™t know this so it needs to be told.
\definelingstyle{quote}{numoffset=\leftmargin}
